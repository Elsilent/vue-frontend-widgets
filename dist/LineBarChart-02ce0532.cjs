"use strict";const e=require("vue"),ee=require("./_plugin-vue_export-helper-f246444f.cjs"),d=require("./Info-ad8c31fe.cjs"),ce={class:"loader"},ue={class:"loader-line"};function ie(g,R){return e.openBlock(),e.createElementBlock("div",ce,[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(5,j=>e.createElementVNode("div",ue)),64))])}const ve={},me=ee._export_sfc(ve,[["render",ie],["__scopeId","data-v-b6993c44"]]),de=g=>(e.pushScopeId("data-v-29784b1d"),g=g(),e.popScopeId(),g),pe={key:0,class:"y-axis-title-container"},he={key:1,class:"y-axis-labels no-spacing"},fe={key:2,class:"y-axis-labels no-spacing"},ke={class:"chart-grid no-spacing"},ge={class:"axis-line no-spacing"},Be={class:"chart-bars no-spacing"},be=de(()=>e.createElementVNode("div",{class:"separator"},null,-1)),ye={key:0,class:"chart-popover-separator no-spacing"},_e={class:"values"},xe=["d","stroke-dasharray"],Ee={class:"chart-hover-sections no-spacing"},Ce=["onMouseover","onMouseout"],Ve={key:0,class:"y-axis-labels no-spacing"},Se={key:1,class:"y-axis-labels no-spacing"},Ne={key:4,class:"y-axis-title-container"},$e=e.defineComponent({__name:"LineBarChart",props:{activeLines:{},axis:{default:4},barSumValues:{},formatters:{},minHeight:{type:Boolean,default:!1},moods:{},noXAxisLabels:{type:Boolean,default:!1},normalize:{type:Boolean,default:!1},showSecondaryYAxis:{type:Boolean,default:!1},smoothing:{default:.15},styles:{},values:{},yAxisTitles:{}},setup(g){const R=g,j=["dashed","opaque"],{activeLines:B,axis:W,barSumValues:K,formatters:b,minHeight:te,moods:X,noXAxisLabels:le,normalize:w,showSecondaryYAxis:q,smoothing:ae,styles:v,values:u,yAxisTitles:M}=e.toRefs(R),y=e.computed(()=>Object.values(u.value).map(o=>Object.keys(o))),m=e.computed(()=>{const o={bar:[],line:[]},n={};for(let a=0;a<A.value;a++)switch(v.value[r.value[a]]){case"bar":for(const s of y.value[a])s in n||(n[s]=0),n[s]+=u.value[r.value[a]][s];break;case"line":o.line.push(...Object.values(u.value[r.value[a]]));break}o.bar=Object.values(n);for(let a=0;a<A.value;a++)v.value[r.value[a]]==="line"&&o.line.push(...Object.values(u.value[r.value[a]]));const t={bar:{},line:{}},l=["bar","line"];for(const a of l)t[a]=r.value.filter(s=>v.value[s]===a).reduce((s,c)=>{const i=o[a],f=Math.min(...i,0),D=Math.max(...i)-f,H=Math.pow(10,Math.ceil(Math.abs(D)).toString().length-2),L=D/(W.value-1),$=Math.ceil(L/H)*H,k=[f];for(let Z=1;Z<W.value;Z++)k.push(k[k.length-1]+$);return s[c]=k.reverse(),s},{});return t}),G=e.computed(()=>{for(const[o,n]of Object.entries(b.value))if(v.value[o]==="bar")return n}),F=e.computed(()=>{const o={};for(const[n,t]of Object.entries(u.value))if(v.value[n]==="bar")for(const[l,a]of Object.entries(t))l in o||(o[l]={}),o[l][n]=a;return o}),A=e.computed(()=>Object.keys(u.value).length),Y=e.computed(()=>{const o=["bar","line"],n={bar:[],line:[]};for(const t of o){let l=r.value[0];for(let a=1;a<r.value.length;a++)r.value[a]in m.value[t]&&(!(l in m.value[t])||m.value[t][r.value[a]][0]>m.value[t][l][0])&&(l=r.value[a]);n[t]=m.value[t][l]}return n}),E=e.computed(()=>Math.max(...Object.values(u.value).map(o=>Object.values(o).length))),r=e.computed(()=>Object.keys(u.value)),z=e.computed(()=>M!=null&&M.value?Object.values(M.value):void 0),oe=(o,n)=>{if(o.length===0)return"";const t=Object.entries(o).map(([c,i])=>({left:S(c),top:h(i,n)})),l=[`M ${t[0].left} ${t[0].top}`],a=(c,i)=>({length:Math.hypot(i.top-c.top,i.left-c.left),angle:Math.atan2(i.top-c.top,i.left-c.left)}),s=(c,i,f,N)=>{const L=a(i??c,f??c);let $=L.angle;N&&($+=Math.PI);const k=L.length*ae.value;return{left:c.left+Math.cos($)*k,top:c.top+Math.sin($)*k}};return t.slice(1).forEach((c,i)=>{const f=s(t[i],t[i-1],c,!1),N=s(c,t[i],t[i+2],!0);l.push(`C ${f.left},${f.top} ${N.left},${N.top} ${c.left},${c.top}`)}),l.join(" ")},O=e.computed(()=>{const t=`${100/Object.keys(F.value).length/2}%`;return{left:t,right:t}}),C=e.ref(),I=e.ref([]),ne=(o,n)=>{n&&(I.value[o]=n)},p=e.ref(),_=e.ref(0),P=()=>{if(!p.value)return;const o=Math.max(...I.value.map(l=>l.clientWidth)),n=Math.max(...I.value.map(l=>l.clientHeight));if(p.value.clientWidth>E.value*o)_.value=0;else if(p.value.clientWidth<E.value*n)_.value=90;else{const l=E.value*o;_.value=Math.cos(p.value.clientWidth/l)*180/Math.PI}const t=_.value*Math.PI/180;C.value=o*Math.sin(t)+n*Math.cos(t)},re=e.computed(()=>({"margin-bottom":C.value===void 0?void 0:`${C.value}px`})),se=e.computed(()=>{const t=`${100/Object.keys(F.value).length/2}%`;return{height:C.value===void 0?void 0:`${C.value}px`,"margin-left":t,"margin-right":t}}),x=e.ref([]),U=o=>{for(const[n,t]of Object.entries(u.value))if(v.value[n]!=="bar"&&Object.keys(t).length<=o)return h(Object.values(t)[o],n);return Math.min(...Object.entries(u.value).filter(([n])=>v.value[n]!=="bar").map(([n,t])=>h(Object.values(t)[o],n)))},V=(o,n)=>{const t=X.value[o],l=n??j,a=J(t);return l.reduce((s,c)=>({...s,[c]:a.attributes.includes(c)}),{[`chart-${a.chart}`]:!!a.chart,[`mood-${a.mood}`]:!!a.mood})},J=o=>{let n=!1,t="mood"in o?o.mood:void 0,l="chart"in o?o.chart.toString():void 0;const a=[];do for(const s of j)(t??l).endsWith(`-${s}`)&&(a.push(s),t?t=t.substring(0,t.length-s.length-1):l&&(l=l.substring(0,l.length-s.length-1)),n=!0);while(n);return{attributes:a,chart:l,mood:t}},S=o=>{const n=Object.keys(Object.values(u.value)[0]).indexOf(o);return E.value===1?50:n*100/(E.value-1)},h=(o,n,t)=>{t||(t=v.value[n]);const[l,a]=(()=>w.value?[m.value[t][n][m.value[t][n].length-1],m.value[t][n][0]]:[Math.min(...Object.values(m.value[t]).map(c=>c[c.length-1])),Math.max(...Object.values(m.value[t]).map(c=>c[0]))])(),s=a-l<=.01?100:Math.min(100,Math.max(0,(a-o)*100/(a-l)));switch(t){case"bar":return 100-s;case"line":default:return s}},Q=(o,n)=>{if(n)x.value.push(o);else{const t=x.value.indexOf(o);t>=0&&x.value.splice(t,1)}};e.watch(u,()=>P());const T=new ResizeObserver(()=>{P()});return e.watch(p,()=>{T.disconnect(),p.value&&T.observe(p.value)}),e.onMounted(()=>{P()}),e.onUnmounted(()=>{T.disconnect()}),(o,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["line-chart no-spacing",{"min-height":e.unref(te)}]),style:e.normalizeStyle(re.value)},[z.value?(e.openBlock(),e.createElementBlock("div",pe,[e.createVNode(d.Info,{class:"y-axis-title no-spacing",important:"",size:"small"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(z.value[0]),1)]),_:1})])):e.createCommentVNode("",!0),e.unref(w)?(e.openBlock(),e.createElementBlock("div",he,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.value[e.unref(v)[r.value[0]]][r.value[0]],t=>(e.openBlock(),e.createBlock(d.Info,{class:"axis-label"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(b)[r.value[0]](t)),1)]),_:2},1024))),256))])):(e.openBlock(),e.createElementBlock("div",fe,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(Y.value[e.unref(v)[r.value[0]]],t=>(e.openBlock(),e.createBlock(d.Info,{class:"axis-label"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(b)[r.value[0]](t)),1)]),_:2},1024))),256))])),e.createElementVNode("div",{class:"chart-contents no-spacing",ref_key:"chartContents",ref:p},[e.createElementVNode("div",ke,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.value[e.unref(v)[r.value[0]]][r.value[0]].slice(1),t=>(e.openBlock(),e.createElementBlock("div",ge))),256))]),e.createElementVNode("div",Be,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(F.value,(t,l)=>(e.openBlock(),e.createElementBlock("div",{class:"chart-bar-container no-spacing",style:e.normalizeStyle({left:`${S(l)}%`})},[be,(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t,(a,s)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[h(a,s)>0?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["chart-bar no-spacing",{...V(s)}]),style:e.normalizeStyle({height:`${h(a,s)}%`})},null,6)):e.createCommentVNode("",!0)],64))),256))],4))),256))]),e.unref(K)&&G.value?(e.openBlock(),e.createElementBlock("div",{key:0,class:"chart-bar-sums no-spacing",style:e.normalizeStyle(O.value)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(K),(t,l)=>(e.openBlock(),e.createElementBlock("div",{class:"chart-bar-sum no-spacing",style:e.normalizeStyle({left:`${S(l)}%`,bottom:`${h(t,l,"bar")}%`})},[e.createVNode(d.Info,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(G.value(t)),1)]),_:2},1024)],4))),256))],4)):e.createCommentVNode("",!0),e.createElementVNode("div",{class:"chart-popovers no-spacing",style:e.normalizeStyle(O.value)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.value[0],(t,l)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[l>0?(e.openBlock(),e.createElementBlock("div",ye)):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass(["chart-popover-container no-spacing",{visible:x.value.includes(t)}])},[e.createElementVNode("div",{class:"chart-popover-line no-spacing",style:e.normalizeStyle({height:`${100-U(l)}%`})},null,4),e.createElementVNode("div",{class:"chart-popover no-spacing",style:e.normalizeStyle({bottom:`${100-U(l)}%`})},[e.renderSlot(o.$slots,"popover",{index:l,values:r.value.map(a=>Object.values(e.unref(u)[a])[l])},()=>[e.createElementVNode("div",_e,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.value,(a,s)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[!e.unref(B)||e.unref(B).includes(r.value[s])&&l<=a.length?(e.openBlock(),e.createBlock(d.Info,{key:0,class:e.normalizeClass(["no-spacing",V(r.value[s])]),important:""},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(b)[r.value[s]](e.unref(u)[r.value[s]][a[l]])),1)]),_:2},1032,["class"])):e.createCommentVNode("",!0)],64))),256))]),e.renderSlot(o.$slots,"popoverAfterValues",{index:l,values:r.value.map(a=>Object.values(e.unref(u)[a])[l])},void 0,!0)],!0)],4)],2)],64))),256))],4),e.createElementVNode("div",{class:"chart-lines no-spacing",style:e.normalizeStyle(O.value)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(u),(t,l)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(v)[l]==="line"?(e.openBlock(),e.createElementBlock("svg",{key:0,class:e.normalizeClass(V(l,[])),height:"100%",preserveAspectRatio:"none",width:"100%",viewBox:"0 0 100 100"},[e.createElementVNode("path",{d:oe(t,l),"stroke-dasharray":J(e.unref(X)[l]).attributes.includes("dashed")?"6 4":void 0,fill:"none",stroke:"currentColor","stroke-width":"2px","vector-effect":"non-scaling-stroke"},null,8,xe)],2)):e.createCommentVNode("",!0)],64))),256))],4),e.createElementVNode("div",{class:"chart-points no-spacing",style:e.normalizeStyle(O.value)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(u),(t,l)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(v)[l]==="line"&&(!e.unref(B)||e.unref(B).includes(l))?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(t,(a,s)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["chart-point",{...V(l),visible:x.value.includes(s)}]),style:e.normalizeStyle({left:`${S(s)}%`,top:`${h(a,l)}%`})},null,6))),256)):e.createCommentVNode("",!0)],64))),256))],4),e.createElementVNode("div",Ee,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.value[0],t=>(e.openBlock(),e.createElementBlock("div",{class:"chart-hover-section no-spacing",onMouseover:l=>Q(t,!0),onMouseout:l=>Q(t,!1)},null,40,Ce))),256))]),e.unref(le)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:1,class:"x-axis-labels no-spacing",style:e.normalizeStyle(se.value)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.value[0],(t,l)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["x-axis-label-group-container no-spacing",{active:x.value.includes(t)}]),style:e.normalizeStyle({left:`${S(t)}%`})},[e.createElementVNode("div",{class:"x-axis-label-group no-spacing",ref_for:!0,ref:a=>ne(l,a),style:e.normalizeStyle({transform:`rotate(-${_.value}deg) translateX(-${_.value*50/90}%)`})},[e.renderSlot(o.$slots,"xAxis",{valueKey:t},()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(A.value,a=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[!e.unref(B)||e.unref(B).includes(r.value[a-1])?(e.openBlock(),e.createBlock(d.Info,{key:0,class:e.normalizeClass(["x-axis-label no-spacing",{...V(r.value[a-1]),"has-label":l<=y.value[a-1].length}]),important:"",size:"small"},{default:e.withCtx(()=>[e.renderSlot(o.$slots,"xAxisLabel",{index:l,lineIndex:a-1,valueKey:t},void 0,!0)]),_:2},1032,["class"])):e.createCommentVNode("",!0)],64))),256))],!0)],4)],6))),256))],4))],512),e.unref(q)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:3},[e.unref(w)?(e.openBlock(),e.createElementBlock("div",Ve,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.value[e.unref(v)[r.value[r.value.length-1]]][r.value[r.value.length-1]],t=>(e.openBlock(),e.createBlock(d.Info,{class:"axis-label"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(b)[r.value[r.value.length-1]](t)),1)]),_:2},1024))),256))])):(e.openBlock(),e.createElementBlock("div",Se,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(Y.value[e.unref(v)[r.value[r.value.length-1]]],t=>(e.openBlock(),e.createBlock(d.Info,{class:"axis-label"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(e.unref(b)[r.value[r.value.length-1]](t)),1)]),_:2},1024))),256))]))],64)):e.createCommentVNode("",!0),e.unref(q)&&z.value?(e.openBlock(),e.createElementBlock("div",Ne,[e.createVNode(d.Info,{class:"y-axis-title no-spacing",important:"",size:"small"},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(z.value[1]),1)]),_:1})])):e.createCommentVNode("",!0)],6))}});const Me=ee._export_sfc($e,[["__scopeId","data-v-29784b1d"]]);exports.LineBarChart=Me;exports.Loader=me;
