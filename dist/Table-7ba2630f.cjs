"use strict";const e=require("vue"),ue=require("./_plugin-vue_export-helper-f246444f.cjs"),pe=require("./datetime-a6d0f4bc.cjs"),he=require("./Icon-80a3c9ab.cjs"),ge={class:"scrollbar"},Ce=e.defineComponent({__name:"ScrollableArea",props:{active:{type:Boolean},mode:{},thumbOffset:{},thumbSize:{}},emits:["mousedown"],setup(Z,{emit:W}){const Y=Z,{active:j,mode:L,thumbOffset:X,thumbSize:V}=e.toRefs(Y),v=e.computed(()=>{const[u,z]=L.value==="vertical"?["top","height"]:["left","width"];return{[u]:`calc(3px + ${X.value} * (100% - ${V.value} - 6px))`,[z]:`${V.value}`}});return(u,z)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["scrollable-area",{active:e.unref(j),[e.unref(L)]:!0}]),onMousedown:z[0]||(z[0]=e.withModifiers(B=>W("mousedown",B),["stop"]))},[e.createElementVNode("div",ge,[e.createElementVNode("div",{class:"thumb",style:e.normalizeStyle(v.value)},null,4)])],34))}});const se=ue._export_sfc(Ce,[["__scopeId","data-v-56aba386"]]),be=e.defineComponent({__name:"Scrollable",props:{mode:{default:"vertical"},optimized:{type:Boolean,default:!1},relativeTo:{},scrollPosition:{default:()=>({left:0,top:0})},scrollHeightDelta:{default:0},scrollWidthDelta:{default:0},staticPosition:{type:Boolean,default:!1},updateKey:{}},emits:["update:scrollPosition"],setup(Z,{emit:W}){const Y=Z,{mode:j,relativeTo:L,scrollPosition:X,scrollHeightDelta:V,scrollWidthDelta:v,staticPosition:u,updateKey:z}=e.toRefs(Y),B=e.ref(!1),E=e.ref(0),$=e.ref(0),g=e.ref(0),y=e.ref(0),b=e.ref(),I=e.ref(),A=e.ref(),M=e.ref(),H=e.ref(),C=e.ref(0),m=e.ref(0),S=e.ref(),_=e.computed(()=>C.value/(y.value-$.value)),F=e.computed(()=>`max(56px, (100% - 14px) * ${$.value/y.value})`),J=e.computed(()=>`max(56px, (100% - 14px) * ${E.value/g.value})`),R=e.computed(()=>m.value/(g.value-E.value)),p=e.ref();e.onUnmounted(()=>{q.disconnect(),U.disconnect()});const K=()=>{b.value&&(S.value!==void 0&&(clearTimeout(S.value),S.value=void 0),B.value=!1,b.value=void 0)},D=()=>L!=null&&L.value?L.value():p.value,ee=i=>{const N=D();N&&N.scrollTo(i)},te=i=>{ee({left:((M==null?void 0:M.value)??0)+i*y.value/($.value-v.value)})},Q=i=>{ee({top:((H==null?void 0:H.value)??0)+i*g.value/(E.value-V.value)})},s=i=>{if(b.value){switch(b.value){case"horizontal":te(i.clientX-((I==null?void 0:I.value)??0));break;case"vertical":Q(i.clientY-((A==null?void 0:A.value)??0));break}i.preventDefault()}},c=()=>{b.value=void 0,re(),window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",c)},r=(i,N)=>{K(),B.value=!0,b.value=N;const O=D();switch(b.value){case"horizontal":I.value=i.clientX,M.value=(O==null?void 0:O.scrollLeft)??0;break;case"vertical":A.value=i.clientY,H.value=(O==null?void 0:O.scrollTop)??0;break}window.addEventListener("mousemove",s),window.addEventListener("mouseup",c)},d=i=>{E.value!==i.clientHeight&&(E.value=i.clientHeight)},k=i=>{$.value!==i.clientWidth&&($.value=i.clientWidth)},T=i=>{g.value!==i.scrollHeight&&(g.value=i.scrollHeight)},w=i=>{y.value!==i.scrollWidth&&(y.value=i.scrollWidth)},P=i=>{C.value=i.scrollLeft,W("update:scrollPosition",{left:C.value,top:m.value})},x=i=>{m.value=i.scrollTop,W("update:scrollPosition",{left:C.value,top:m.value})},G=()=>{const i=D();i&&(d(i),k(i),T(i),w(i))},q=new MutationObserver(()=>G()),U=new ResizeObserver(()=>G()),oe=i=>{P(i.target),x(i.target)},re=()=>{G(),!b.value&&(K(),B.value=!0,S.value=window.setTimeout(()=>{B.value=!1},2500))},ne=()=>{q.disconnect(),U.disconnect();const i=D();i&&(q.observe(i,{childList:!0,subtree:!0}),U.observe(i))};return e.onMounted(()=>{ne()}),e.watch(L,()=>ne()),e.watch(X,i=>{C.value=i.left,m.value=i.top,e.nextTick(()=>ee(i))},{deep:!0,immediate:!0}),e.watch(z,()=>{console.log(z.value)}),(i,N)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["scrollable",{[`mode-${e.unref(j)}`]:!0,static:e.unref(u)}])},[e.withMemo(i.optimized?[e.unref(z)]:void 0,()=>(e.openBlock(),e.createElementBlock("div",{class:"scrollable-content",ref_key:"content",ref:p,key:e.unref(z),onMousemove:re,onScroll:oe},[e.renderSlot(i.$slots,"default",{},void 0,!0)],32)),N,0),e.unref(j)!=="vertical"?(e.openBlock(),e.createBlock(se,{key:0,onMousedown:N[1]||(N[1]=e.withModifiers(O=>r(O,"horizontal"),["stop"])),active:y.value>$.value&&(B.value||b.value==="horizontal"),class:e.normalizeClass({"scrollbar-visible":y.value>$.value}),thumbOffset:_.value,thumbSize:F.value,mode:"horizontal"},null,8,["active","class","thumbOffset","thumbSize"])):e.createCommentVNode("",!0),e.unref(j)==="both-top"?(e.openBlock(),e.createBlock(se,{key:1,onMousedown:N[2]||(N[2]=e.withModifiers(O=>r(O,"horizontal"),["stop"])),active:y.value>$.value&&(B.value||b.value==="horizontal"),class:e.normalizeClass({"scrollbar-visible":y.value>$.value}),thumbOffset:_.value,thumbSize:F.value,mode:"horizontal-top"},null,8,["active","class","thumbOffset","thumbSize"])):e.createCommentVNode("",!0),e.unref(j)!=="horizontal"?(e.openBlock(),e.createBlock(se,{key:2,onMousedown:N[3]||(N[3]=e.withModifiers(O=>r(O,"vertical"),["stop"])),active:g.value>E.value&&(B.value||b.value==="vertical"),class:e.normalizeClass({"scrollbar-visible":g.value>E.value}),thumbOffset:R.value,thumbSize:J.value,mode:"vertical"},null,8,["active","class","thumbOffset","thumbSize"])):e.createCommentVNode("",!0)],2))}});const me=ue._export_sfc(be,[["__scopeId","data-v-a8f76777"]]),ke=["onClick","onMousedown","data-column"],we=["onClick"],Be=["data-column"],ye={key:0,class:"cell column cell-additional-header row-number"},Se=["data-additionalHeader","data-column"],Te={key:0,class:"cell total top-total row-number"},$e=["data-column","data-subcolumn-index"],Me=["data-column"],Ne=["onClick","data-column","data-subcolumn-index"],ze=["data-column","data-primary-key"],Ee=["data-column","data-primary-key","data-subcolumn-index"],He=["innerHTML"],_e={key:0,class:"cell total row-number"},Re=["data-column","data-subcolumn-index"],Oe=["data-column"],Le=e.defineComponent({__name:"SimpleTable",props:{additionalHeaders:{default:()=>({})},cellClasses:{default:()=>({})},colorMetrics:{type:Boolean,default:!1},coloredMetrics:{default:()=>[]},columns:{},comparisonColumnKeys:{},detailsRows:{},dragColumns:{type:Boolean,default:!1},inversedKpis:{},noDataMessage:{default:"&nbsp;"},orderBy:{},orderColumnType:{},primaryColumn:{default:"id"},rows:{},showNoDataMessage:{type:Boolean,default:!1},showRowNumber:{type:Boolean,default:!0},showTotal:{type:Boolean,default:!0},showTopTotal:{type:Boolean,default:!1}},emits:["update:orderBy","addColoredMetric","removeColoredMetric","move:column"],setup(Z,{emit:W}){const Y=Z,{additionalHeaders:j,cellClasses:L,colorMetrics:X,coloredMetrics:V,columns:v,comparisonColumnKeys:u,detailsRows:z,dragColumns:B,inversedKpis:E,noDataMessage:$,orderBy:g,orderColumnType:y,primaryColumn:b,rows:I,showNoDataMessage:A,showRowNumber:M,showTotal:H,showTopTotal:C}=e.toRefs(Y);e.onUpdated(()=>console.log(`updated ${Object.values(v.value).length}`));const m=e.ref(),S=e.ref(),_=e.ref(0),F=e.ref(0),J=e.ref(0),R=e.ref({}),p=e.computed(()=>Object.entries(v.value).filter(([o,{visible:l}])=>l).map(([o,l])=>o)),K=e.computed(()=>p.value.length+(M.value?1:0)),D=e.computed(()=>_.value>3),ee=e.computed(()=>Object.values(I.value).reduce((o,l)=>{for(const[t,n]of Object.entries(v.value))if(n.type!=="string")if(u!=null&&u.value&&(n.colspan??0)>1){t in o||(o[t]=Object.entries(l[t]).reduce((a,[f,h])=>(a[f]=parseFloat(h),a),{}));for(const a in o[t])o[t][a]>l[t][a]&&(o[t][a]=parseFloat(l[t][a]))}else(!(t in o)||o[t]>l[t])&&(o[t]=parseFloat(l[t]));return o},{})),te=e.computed(()=>Object.values(I.value).reduce((o,l)=>{for(const[t,n]of Object.entries(v.value))if(n.type!=="string")if(u!=null&&u.value&&(n.colspan??0)>1){t in o||(o[t]=Object.entries(l[t]).reduce((a,[f,h])=>(a[f]=parseFloat(h),a),{}));for(const a in o[t])o[t][a]<l[t][a]&&(o[t][a]=parseFloat(l[t][a]))}else(!(t in o)||o[t]<l[t])&&(o[t]=parseFloat(l[t]));return o},{})),Q=e.computed(()=>u!=null&&u.value?p.value.map(o=>v.value[o].rowspan??1).reduce((o,l)=>o>l?o:l):1),s=e.computed(()=>Object.values(I.value).sort((o,l)=>{const t=(()=>{const n=G(g.value[0].reduce((f,h)=>f[h],o),y.value),a=G(g.value[0].reduce((f,h)=>f[h],l),y.value);return n>a?1:n<a?-1:0})();return g.value[1]?-t:t}).reduce((o,l,t)=>(o.push({...l,rowInfo:{index:t,detailable:!0}}),z.value[l[b.value]]&&o.push(...Object.entries(z.value[l[b.value]]).map(([n,a])=>({...a,rowInfo:{index:t,subindex:n,detailable:!1}}))),o),[])),c=e.computed(()=>{let o=0;for(const t of p.value){const n=v.value[t];n.colspan&&(u!=null&&u.value)?o+=n.colspan:o++}let l=`repeat(${o}, auto)`;return M.value&&(l=`min-content ${l}`),{"grid-template-columns":l}}),r=o=>R.value[o]?R.value[o].height:0,d=(o,l,t,n)=>{const a={...L.value,even:l%2===0};if(X.value){const f=(()=>!E||!E.value?"positive":E.value.includes(t)?"negative":"positive")();a[`color-intensity-${k(o[t],t,n)}`]=!0,a[`color-${f}`]=!0,n!==void 0&&u&&u.value&&u.value[n]==="difference"?a.colored=!1:a.colored=U(t)>=0}return a},k=(o,l,t)=>{if(v.value[l].type==="string")return;let n=o,a=te.value[l],f=ee.value[l];return u&&u.value&&t!==void 0&&(n=n[u.value[t]],a=a[u.value[t]],f=f[u.value[t]]),a===f?0:Math.round((n-f)*10/(a-f))},T=(o,l)=>{const t=v.value[o],n=[o];l!==void 0&&(u&&u.value?n.push(u.value[l]):n.push(l.toString()));const a=g.value[0]?g.value[0].every((f,h)=>f===n[h]):!1;return{"column-main-extended":l===void 0&&(t.rowspan??0)>1,dragged:m.value?p.value[m.value]===o:!1,"drag-mode":D.value,orderable:!(u&&u.value)||(t.colspan??1)===1||l!==void 0,"ordered-by":a,[`order-direction-${g.value[1]?"desc":"asc"}`]:a}},w=o=>{const l={};if(R.value[o])if(m.value!==void 0&&p.value[m.value]===o){const{height:t,left:n,width:a}=R.value[o];l.left=`${Math.floor(n+J.value-F.value)}px`,l.height=`${t+1}px`,l.width=`${Math.round(a)}px`}else{const t=p.value.indexOf(o);let n=(()=>{if(m.value===void 0||S.value===void 0)return 0;if(m.value<t){if(S.value>=t)return-R.value[p.value[m.value]].width}else if(S.value<=t)return R.value[p.value[m.value]].width;return 0})();const{height:a,left:f,width:h}=R.value[o];l.left=`${Math.floor(f+n)}px`,l.height=`${a+1}px`,l.width=`${Math.floor(h)}px`}return l},P=o=>{const l=v.value[o],t={};return u&&u.value&&(l.colspan&&(t["grid-column-end"]=`span ${l.colspan}`),l.rowspan&&(t["grid-row-end"]=`span ${l.rowspan}`)),t},x=o=>u&&u.value?u.value[o]:void 0,G=(o,l)=>{switch(l){case"float":case"int":case"money":case"money_capped":case"percent":case"time":return parseFloat(o??0);case"date":return pe.DateTime.fromISO(o).toUnixInteger();default:return o}},q=o=>o.subindex===void 0?o.index+1:`${o.index+1}.${o.subindex+1}`,U=o=>V.value.findIndex(l=>l===o),oe=o=>X.value&&!["date","string"].includes(v.value[o].type),re=(o,l)=>{if(u&&u.value&&v.value[o].colspan&&l===void 0||m.value!==void 0&&D.value&&p.value[m.value]===o)return;const t=[o];l!==void 0&&(u&&u.value?t.push(u.value[l]):t.push(l.toString()));const n=t.every((f,h)=>f===g.value[0][h]),a=(()=>n?!g.value[1]:v.value[o].type!=="string")();W("update:orderBy",[t,a])},ne=(o,l)=>{B.value&&(m.value=p.value.indexOf(o),S.value=m.value,_.value=0,F.value=l.clientX,J.value=l.clientX,window.addEventListener("mousemove",i),window.addEventListener("mouseup",N))},i=o=>{if(m.value===void 0)return;_.value++,J.value=o.clientX;const l=Object.entries(v.value).filter(([h,le])=>le.visible).map(([h])=>h).map((h,le)=>({columnIndex:parseInt(le.toString()),sizing:R.value[h]})),t=l[m.value].sizing,n=t.width/2,f=t.left+J.value-F.value;S.value=(()=>{for(const{columnIndex:h,sizing:le}of l)if(f+n-le.left-le.width<0)return h;return l.length})()},N=o=>{if(m.value===void 0||S.value===void 0)return;D.value&&S.value!==m.value&&W("move:column",{from:m.value,to:S.value}),S.value=void 0,_.value=0,m.value=void 0,window.removeEventListener("mousemove",i),window.removeEventListener("mouseup",N)},O=o=>{U(o)>=0?W("removeColoredMetric",o):W("addColoredMetric",o)},ae=e.ref({}),fe=(o,l)=>{l&&(ae.value[o]=l)},ie=e.ref(),ce=()=>{if(!ie.value)return;const o=ie.value.getBoundingClientRect();R.value=Object.entries(v.value).reduce((l,[t,n])=>{if(n.visible&&ae.value[t]){const a=ae.value[t].getBoundingClientRect();l[t]={height:a.height,left:a.left-o.left,width:a.width}}return l},{})},ve=new ResizeObserver(()=>{ce()});return e.watch(ae,()=>{ve.disconnect();for(const o of Object.values(ae.value))ve.observe(o);ce()},{deep:!0,immediate:!0}),ce(),(o,l)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["table",{"with-secondary":!!e.unref(u)&&p.value.some(t=>(e.unref(v)[t].colspan||1)!==1)}]),ref_key:"table",ref:ie,style:e.normalizeStyle(c.value)},[e.unref(M)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"cell column column-main row-number",style:e.normalizeStyle(Q.value>1?{"grid-row-end":`span ${Q.value}`}:void 0)},[e.renderSlot(o.$slots,"columnRowNumber",{},()=>[e.createTextVNode("#")],!0)],4)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.value,t=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(v)[t].visible?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["cell column column-main",T(t)]),ref_for:!0,ref:n=>fe(t,n),onClick:e.withModifiers(()=>re(t),["stop"]),onMousedown:n=>ne(t,n),style:e.normalizeStyle(P(t)),"data-column":t},[e.renderSlot(o.$slots,"column",{columnKey:t,isGhost:!1},void 0,!0),oe(t)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"toggle-colored no-spacing",onClick:e.withModifiers(()=>O(t),["stop"]),style:e.normalizeStyle({top:`${r(t)}px`})},[e.renderSlot(o.$slots,"colorizeLabel",{enabled:U(t)>=0},void 0,!0)],12,we)):e.createCommentVNode("",!0)],46,ke)):e.createCommentVNode("",!0)],64))),256)),e.unref(B)?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(p.value,t=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(v)[t].visible?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["cell column column-main column-ghost",T(t)]),style:e.normalizeStyle(w(t)),"data-column":t},[e.renderSlot(o.$slots,"column",{columnKey:t,isGhost:!0},void 0,!0)],14,Be)):e.createCommentVNode("",!0)],64))),256)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(j),(t,n)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(M)?(e.openBlock(),e.createElementBlock("div",ye,[e.createVNode(he.Icon,{value:t.icon},null,8,["value"])])):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.value,a=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["cell column cell-additional-header",[`cell-additional-header-${a}`]]),"data-additionalHeader":n,"data-column":a},[e.renderSlot(o.$slots,"additionalHeader",{additionalHeader:n,columnKey:a},void 0,!0)],10,Se))),256))],64))),256)),e.unref(C)&&e.unref(H)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:2},[e.unref(M)?(e.openBlock(),e.createElementBlock("div",Te,[e.renderSlot(o.$slots,"topTotalRowNumber",{},void 0,!0)])):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.value,t=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(v)[t].visible?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.unref(u)&&(e.unref(v)[t].colspan||1)!==1?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(e.unref(v)[t].colspan,n=>(e.openBlock(),e.createElementBlock("div",{class:"cell total top-total","data-column":t,"data-subcolumn-index":n-1},[e.renderSlot(o.$slots,"topTotal",{columnKey:t,subcolumnKey:x(n-1),values:s.value.map(a=>a[t])},void 0,!0)],8,$e))),256)):(e.openBlock(),e.createElementBlock("div",{key:1,class:"cell total top-total","data-column":t},[e.renderSlot(o.$slots,"topTotal",{columnKey:t,values:s.value.map(n=>n[t])},void 0,!0)],8,Me))],64)):e.createCommentVNode("",!0)],64))),256))],64)):e.createCommentVNode("",!0),e.unref(u)?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:3},e.renderList(p.value,t=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(v)[t].visible&&e.unref(v)[t].colspan?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(e.unref(v)[t].colspan,n=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["cell column column-secondary",T(t,n-1)]),onClick:e.withModifiers(()=>re(t,n-1),["stop"]),"data-column":t,"data-subcolumn-index":n-1},[e.renderSlot(o.$slots,"secondaryColumn",{columnKey:t,subcolumnKey:x(n-1)},void 0,!0)],10,Ne))),256)):e.createCommentVNode("",!0)],64))),256)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.value,(t,n)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(M)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["cell row-number",{even:n%2===0}])},[e.renderSlot(o.$slots,"rowNumber",{value:q(t.rowInfo)},()=>[e.createTextVNode(e.toDisplayString(q(t.rowInfo)),1)],!0)],2)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.value,a=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[!e.unref(u)||(e.unref(v)[a].colspan||1)===1?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["cell",d(t,n,a)]),"data-column":a,"data-primary-key":t[e.unref(b)]},[e.renderSlot(o.$slots,"row",{columnKey:a,index:n,row:t,subindex:t.rowInfo.subindex,value:t[a]},void 0,!0)],10,ze)):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(e.unref(v)[a].colspan,f=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["cell",d(t,n,a,f-1)]),"data-column":a,"data-primary-key":t[e.unref(b)],"data-subcolumn-index":f-1},[e.renderSlot(o.$slots,"row",{columnKey:a,index:n,row:t,spanIndex:e.unref(u)?e.unref(u)[f-1]:f-1,subcolumnKey:x(f-1),subindex:t.rowInfo.subindex,value:t[a]?t[a][e.unref(u)?e.unref(u)[f-1]:f-1]:void 0},void 0,!0)],10,Ee))),256))],64))),256))],64))),256)),s.value.length===0&&e.unref(A)?(e.openBlock(),e.createElementBlock("div",{class:"cell odd no-data",key:"row-no-data",style:e.normalizeStyle({"grid-column":`1 / span ${K.value}`}),innerHTML:e.unref($)},null,12,He)):e.createCommentVNode("",!0),e.unref(H)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:5},[e.unref(M)?(e.openBlock(),e.createElementBlock("div",_e,[e.renderSlot(o.$slots,"totalRowNumber",{},()=>[e.createTextVNode("#")],!0)])):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.value,t=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(v)[t].visible?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.unref(u)&&(e.unref(v)[t].colspan||1)!==1?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(e.unref(v)[t].colspan,n=>(e.openBlock(),e.createElementBlock("div",{class:"cell total","data-column":t,"data-subcolumn-index":n-1},[e.renderSlot(o.$slots,"total",{columnKey:t,subcolumnKey:x(n-1),values:s.value.map(a=>a[t])},void 0,!0)],8,Re))),256)):(e.openBlock(),e.createElementBlock("div",{key:1,class:"cell total","data-column":t},[e.renderSlot(o.$slots,"total",{columnKey:t,values:s.value.map(n=>n[t])},void 0,!0)],8,Oe))],64)):e.createCommentVNode("",!0)],64))),256))],64)):e.createCommentVNode("",!0)],6))}});const de=ue._export_sfc(Le,[["__scopeId","data-v-4fdb8f08"]]),Ve=e.defineComponent({__name:"Table",props:{additionalHeaders:{default:()=>({})},cellClasses:{default:()=>({})},colorMetrics:{type:Boolean,default:!1},coloredMetrics:{default:()=>[]},columns:{},comparisonColumnKeys:{default:()=>[]},detailsRows:{},dragColumns:{type:Boolean,default:!1},fixedColumnNumber:{default:1},inversedKpis:{default:()=>[]},noDataMessage:{},orderBy:{},primaryColumn:{default:"id"},rows:{},scrollPosition:{default:()=>({left:0,top:0})},showRowNumber:{type:Boolean,default:!0},showTopTotal:{type:Boolean,default:!1},showTotal:{type:Boolean,default:!0}},setup(Z){const W=Z,{additionalHeaders:Y,cellClasses:j,colorMetrics:L,coloredMetrics:X,columns:V,comparisonColumnKeys:v,detailsRows:u,dragColumns:z,fixedColumnNumber:B,inversedKpis:E,orderBy:$,primaryColumn:g,rows:y,scrollPosition:b,showRowNumber:I,showTopTotal:A,showTotal:M}=e.toRefs(W),H=e.ref(0),C=e.ref(),m=e.ref(0),S=e.ref(0);e.onUnmounted(()=>te.disconnect());const _=e.computed(()=>Object.keys(V.value).slice(0,B.value).reduce((s,c)=>(s[c]=V.value[c],s),{})),F=e.computed(()=>Object.keys(V.value).slice(B.value).reduce((s,c)=>(s[c]=V.value[c],s),{})),J=e.computed(()=>Object.keys(u.value).reduce((s,c)=>s+c.length,Object.values(y.value).length)),R=e.computed(()=>{var c,r,d;const s={};return(c=C.value)!=null&&c.main&&(s["--header-main-height"]=`${C.value.main}px`),(r=C.value)!=null&&r.secondary&&(s["--header-secondary-height"]=`${C.value.secondary}px`),H.value&&(s["--fixed-width"]=`${H.value}px`),(d=C.value)!=null&&d.total&&(s["--header-total-height"]=`${C.value.total}px`),m.value?(s["--total-height"]=`${m.value}px`,s["--bottom-height"]=s["--total-height"]):(J.value===1?s["--total-scrollbar-display"]="none":s["--total-height"]="20px",s["--bottom-height"]="0px"),s}),p=e.ref(),K=e.ref(),D=e.ref(!1),ee=()=>{var d,k;if(D.value)return;D.value=!0,H.value=0,C.value=void 0,m.value=0;const s=T=>{const w={hasSecondary:!1,mainColumnHeight:0,secondaryColumnHeight:0,totalColumnHeight:0,totalHeight:0,width:0};if(!T)return w;const P=[...T.querySelectorAll(".cell.column-main")],x=T.querySelector(".cell.column-secondary"),G=T.querySelector(".cell.total"),q=[];return P.length>0&&(w.mainColumnHeight=P[0].offsetHeight,w.width=P.reduce((U,{offsetWidth:oe})=>U+oe,0),q.push(w.mainColumnHeight)),x&&(w.hasSecondary=!0,w.secondaryColumnHeight=x.offsetHeight,q.push(w.secondaryColumnHeight)),w.totalColumnHeight=q.reduce((U,oe)=>U+oe+1,-1),G&&(w.totalHeight=G.offsetHeight),w},c=s((d=p.value)==null?void 0:d.$el),r=s((k=K.value)==null?void 0:k.$el);if(r.hasSecondary)H.value=c.width,C.value={main:r.mainColumnHeight,secondary:r.secondaryColumnHeight,total:Math.max(c.totalColumnHeight,r.totalColumnHeight)},m.value=c.totalHeight;else{const T=Math.max(c.totalColumnHeight,r.totalColumnHeight);H.value=c.width,C.value={main:T,total:T},m.value=c.totalHeight}e.nextTick(()=>{D.value=!1})},te=new ResizeObserver(()=>ee()),Q=e.ref();return e.nextTick(()=>{te.disconnect(),Q.value&&te.observe(Q.value)}),e.watch(y,()=>{S.value=Math.random()}),(s,c)=>(e.openBlock(),e.createElementBlock("div",{class:"table-container",ref_key:"tableContainer",ref:Q},[e.createVNode(me,{"onUpdate:scrollPosition":c[7]||(c[7]=r=>s.$emit("update:scrollPosition",r)),scrollHeightDelta:(C.value?C.value.total:0)+m.value-40,scrollPosition:e.unref(b),scrollWidthDelta:H.value,style:e.normalizeStyle(R.value),updateKey:S.value,mode:"both-top",optimized:""},{default:e.withCtx(()=>[e.createVNode(de,{class:"fixed",ref_key:"fixedTable",ref:p,onAddColoredMetric:c[0]||(c[0]=r=>s.$emit("addColoredMetric",r)),onRemoveColoredMetric:c[1]||(c[1]=r=>s.$emit("removeColoredMetric",r)),"onUpdate:orderBy":c[2]||(c[2]=r=>s.$emit("update:orderBy",r)),additionalHeaders:e.unref(Y),cellClasses:e.unref(j),colorMetrics:e.unref(L),coloredMetrics:e.unref(X),columns:_.value,comparisonColumnKeys:e.unref(v),detailsRows:e.unref(u),dragColumns:!1,inversedKpis:e.unref(E),orderBy:e.unref($),orderColumnType:e.unref(V)[e.unref($)[0][0]].type,primaryColumn:e.unref(g),rows:e.unref(y),showNoDataMessage:!0,showRowNumber:e.unref(I),showTopTotal:e.unref(A),showTotal:e.unref(M)},{columnRowNumber:e.withCtx(()=>[e.renderSlot(s.$slots,"columnRowNumber",{},()=>[e.createTextVNode("#")],!0)]),colorizeLabel:e.withCtx(({enabled:r})=>[e.renderSlot(s.$slots,"colorizeLabel",{enabled:r},void 0,!0)]),column:e.withCtx(({columnKey:r,isGhost:d})=>[r in _.value?e.renderSlot(s.$slots,"column",{key:0,columnKey:r,isGhost:d},void 0,!0):e.createCommentVNode("",!0)]),additionalHeader:e.withCtx(({additionalHeader:r,columnKey:d})=>[e.renderSlot(s.$slots,"additionalHeader",{additionalHeader:r,columnKey:d},void 0,!0)]),topTotal:e.withCtx(({columnKey:r,subcolumnKey:d,values:k})=>[r in _.value?e.renderSlot(s.$slots,"topTotal",{key:0,columnKey:r,subcolumnKey:d,values:k},void 0,!0):e.createCommentVNode("",!0)]),topTotalRowNumber:e.withCtx(()=>[e.renderSlot(s.$slots,"topTotalRowNumber",{},void 0,!0)]),secondaryColumn:e.withCtx(({columnKey:r,subcolumnKey:d})=>[r in _.value?e.renderSlot(s.$slots,"secondaryColumn",{key:0,columnKey:r,subcolumnKey:d},void 0,!0):e.createCommentVNode("",!0)]),rowNumber:e.withCtx(({value:r})=>[e.renderSlot(s.$slots,"rowNumber",{value:r},void 0,!0)]),row:e.withCtx(({columnKey:r,index:d,row:k,spanIndex:T,subcolumnKey:w,subindex:P,value:x})=>[r in _.value?e.renderSlot(s.$slots,"row",{key:0,columnKey:r,index:d,row:k,spanIndex:T,subcolumnKey:w,subindex:P,value:x},void 0,!0):e.createCommentVNode("",!0)]),totalRowNumber:e.withCtx(()=>[e.renderSlot(s.$slots,"totalRowNumber",{},()=>[e.createTextVNode("#")],!0)]),total:e.withCtx(({columnKey:r,subcolumnKey:d,values:k})=>[r in _.value?e.renderSlot(s.$slots,"total",{key:0,columnKey:r,subcolumnKey:d,values:k},void 0,!0):e.createCommentVNode("",!0)]),_:3},8,["additionalHeaders","cellClasses","colorMetrics","coloredMetrics","columns","comparisonColumnKeys","detailsRows","inversedKpis","orderBy","orderColumnType","primaryColumn","rows","showRowNumber","showTopTotal","showTotal"]),e.createVNode(de,{ref_key:"scrollableTable",ref:K,onAddColoredMetric:c[3]||(c[3]=r=>s.$emit("addColoredMetric",r)),"onMove:column":c[4]||(c[4]=({from:r,to:d})=>s.$emit("move:column",{from:r+e.unref(B),to:d+e.unref(B)})),onRemoveColoredMetric:c[5]||(c[5]=r=>s.$emit("removeColoredMetric",r)),"onUpdate:orderBy":c[6]||(c[6]=r=>s.$emit("update:orderBy",r)),additionalHeaders:e.unref(Y),cellClasses:e.unref(j),colorMetrics:e.unref(L),coloredMetrics:e.unref(X),columns:F.value,comparisonColumnKeys:e.unref(v),detailsRows:e.unref(u),inversedKpis:e.unref(E),dragColumns:e.unref(z),orderBy:e.unref($),orderColumnType:e.unref(V)[e.unref($)[0][0]].type,primaryColumn:e.unref(g),rows:e.unref(y),showRowNumber:!1,showTopTotal:e.unref(A),showTotal:e.unref(M),showNoDataMessage:!0,noDataMessage:s.noDataMessage,style:e.normalizeStyle(R.value)},{colorizeLabel:e.withCtx(({enabled:r})=>[e.renderSlot(s.$slots,"colorizeLabel",{enabled:r},void 0,!0)]),column:e.withCtx(({columnKey:r,isGhost:d})=>[r in F.value?e.renderSlot(s.$slots,"column",{key:0,columnKey:r,isGhost:d},void 0,!0):e.createCommentVNode("",!0)]),additionalHeader:e.withCtx(({additionalHeader:r,columnKey:d})=>[e.renderSlot(s.$slots,"additionalHeader",{additionalHeader:r,columnKey:d},void 0,!0)]),topTotal:e.withCtx(({columnKey:r,subcolumnKey:d,values:k})=>[r in F.value?e.renderSlot(s.$slots,"topTotal",{key:0,columnKey:r,subcolumnKey:d,values:k},void 0,!0):e.createCommentVNode("",!0)]),secondaryColumn:e.withCtx(({columnKey:r,subcolumnKey:d})=>[r in F.value?e.renderSlot(s.$slots,"secondaryColumn",{key:0,columnKey:r,subcolumnKey:d},void 0,!0):e.createCommentVNode("",!0)]),row:e.withCtx(({columnKey:r,index:d,row:k,spanIndex:T,subcolumnKey:w,subindex:P,value:x})=>[r in F.value?e.renderSlot(s.$slots,"row",{key:0,columnKey:r,index:d,row:k,spanIndex:T,subcolumnKey:w,subindex:P,value:x},void 0,!0):e.createCommentVNode("",!0)]),total:e.withCtx(({columnKey:r,subcolumnKey:d,values:k})=>[r in F.value?e.renderSlot(s.$slots,"total",{key:0,columnKey:r,subcolumnKey:d,values:k},void 0,!0):e.createCommentVNode("",!0)]),_:3},8,["additionalHeaders","cellClasses","colorMetrics","coloredMetrics","columns","comparisonColumnKeys","detailsRows","inversedKpis","dragColumns","orderBy","orderColumnType","primaryColumn","rows","showTopTotal","showTotal","noDataMessage","style"])]),_:3},8,["scrollHeightDelta","scrollPosition","scrollWidthDelta","style","updateKey"])],512))}});const Fe=ue._export_sfc(Ve,[["__scopeId","data-v-157d1b2f"]]);exports.Scrollable=me;exports.ScrollableArea=se;exports.SimpleTable=de;exports.Table=Fe;
